<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">


<title data-react-helmet="true">Building a bot with Convai | Convai</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Convai"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="Step by step guide to make your first simple bot on Convai Studio"><meta data-react-helmet="true" property="og:description" content="Step by step guide to make your first simple bot on Convai Studio"><meta data-react-helmet="true" property="og:url" content="https://docs.convai.dev/convai-studio/simple-bot/building-a-bot">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.c809844f.css">


<link rel="preload" href="/styles.addc9a9b.js" as="script">

<link rel="preload" href="/runtime~main.dd004d8d.js" as="script">

<link rel="preload" href="/main.e4c7c466.js" as="script">

<link rel="preload" href="/1.0b6448a8.js" as="script">

<link rel="preload" href="/2.10f14db9.js" as="script">

<link rel="preload" href="/103.43e4efd2.js" as="script">

<link rel="preload" href="/ec1ed54d.259c8859.js" as="script">

<link rel="preload" href="/17896441.c7e96f9c.js" as="script">

<link rel="preload" href="/83860a76.d7b5702a.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Convai"><strong>Convai</strong></a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/convai-studio/introduction">Docs</a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Convai"><strong>Convai</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="navbar__link--active" href="/convai-studio/introduction">Docs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/logo.png" alt="Convai"><strong>Convai</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Convai Studio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Create a Simple Bot</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/simple-bot/understanding-convai">1. Understanding Convai</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/simple-bot/building-a-bot">2. Building a bot</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/simple-bot/adding-fallback">3. Adding Fallback</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/simple-bot/adding-channels">4. Adding Channels</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/simple-bot/deployment">5. Deployment</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Nodes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Stock</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/add-channel-user">Add Channel User Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/basic">Basic Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/delete-data">Delete Data Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/input">Input Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/merge-users">Merge Users Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/one-time-broadcast">One Time Broadcast Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/response">Response Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/script">Script Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/set-data">Set Data Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/stock/webhook">Webhook Node</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Knowledge AI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/knowledge-ai/knowledge">Knowledge Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/knowledge-ai/knowledge-feedback">Knowledge Feedback Node</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">NLP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/nlp/nlp">NLP Node</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Facebook</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/facebook/facebook-mark-seen">Facebook Mark Seen Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/facebook/facebook-profile-info">Facebook Profile Info Node</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Twilio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/twilio/twilio-hang-up">Twilio Hang Up Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/twilio/twilio-dial">Twilio Dial Node</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/twilio/twilio-twiml">Twilio TwiML Node</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Analytics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/nodes/analytics/dashbot">Dashbot Node</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Links</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/basic-link">Basic Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/intent-link">Intent Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/data-equals-link">Data Equals Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/text-link">Text Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/error-link">Error Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/channel-link">Channel Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/broadcast-type-link">Broadcast Type Link</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/links/priority-link">Priority Link</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Integrations</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Analytics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/integrations/analytics/chatbase">Chatbase</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/integrations/analytics/dashbot">Dashbot</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Channels</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/integrations/channels/facebook">Facebook</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/integrations/channels/slack">Slack</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/integrations/channels/twilio">Twilio</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">NLP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/convai-studio/integrations/nlp/dialogflow">Dialogflow</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">NodeJs SDK</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/setup">Setup</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Methods</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/broadcast">Broadcast</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/delete-channel-user">Delete Channel User</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/delete-session">Delete Session</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/delete-super-user">Delete Super User</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/merge-users">Merge Users</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/query-executions">Query Executions</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/query-users">Query Users</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/query-users-reachable">Query Users Reachable</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/update-session">Update Session</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/methods/update-user-data">Update User Data</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Classes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/classes/context-modifier">Context Modifier</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/classes/execution-matcher">Execution Matcher</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/classes/flaggable">Flaggable</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/classes/session">Session</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/classes/user-query-builder">User Query Builder</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Models</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/broadcast-input">Broadcast Input</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/broadcast-result">Broadcast Result</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/channel-user">Channel User</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/context-change">Context Change</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/error">Error</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/execution">Execution</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/execution-log">Execution Log</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/execution-query-result">Execution Query Result</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/frame">Frame</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/log-entry">Log Entry</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/merge-users-request">Merge Users Request</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/message">Message</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/query-check">Query Check</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/response">Response</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/response-block">Response Block</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/stack">Stack</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/super-user">Super User</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/update-user-input-data">Update User Input Data</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/user-query">User Query</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/user-query-reachable-result">User Query Reachable Result</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/models/user-query-result">User Query Result</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Enums</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/enums/context-modifier-type">Context Modifier Type</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/enums/context-modifier-operation">Context Modifier Operation</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/enums/execution-operation">Execution Operation</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/enums/log-level">Log Level</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/enums/user-query-mode">User Query Mode</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/node-sdk/enums/user-query-operation">User Query Operation</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Building a bot with Convai</h1></header><div class="markdown"><p>New to Convai? Start from <a href="../understanding-convai">Understanding Convai</a> guide.</p><p>In this tutorial we will be making a Trivia bot. We will be using Dialogflow&#x27;s NLP, <a href="https://opentdb.com/">third-party API Service</a> and Dashbot&#x27;s Analytics. Let&#x27;s start by creating a bot.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="creating-the-bot"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-the-bot" title="Direct link to heading">#</a>Creating the bot</h2><ol><li><p>Login to Convai Studio. Under Misc &gt; Bots, click on the “Make Bot” Button to begin making your bot.</p><img alt="make bot" src="/img/convai-studio/simple-bot/building-bot/image78.png"></li><li><p>In the name field enter “Tutorial Bot”.</p><img alt="create tutorial bot" src="/img/convai-studio/simple-bot/building-bot/image103.png"></li><li><p>After the bot is created, you will be taken to the bot’s Dashboard by default. Click on the double right arrow button at the bottom of the left side panel to view different Side Navigation(we will refer to it as Nav by short) of this bot.</p><img alt="nav collapsed" src="/img/convai-studio/simple-bot/building-bot/image44.png"><img alt="nav expanded" src="/img/convai-studio/simple-bot/building-bot/image29.png"></li><li><p>Go to Graph in the Nav. The majority of the work with your bot will take place here. You can zoom in/out using your mouse’s wheel and left-click drag on empty space to move your view of the graph..</p><img alt="graph overview" src="/img/convai-studio/simple-bot/building-bot/image66.png"></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="connecting-nlp"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#connecting-nlp" title="Direct link to heading">#</a>Connecting NLP</h2><ol><li><p>Let’s add the NLP integration as a starting point. Here we will use DialogFlow as the bot’s NLP. Use the <a href="/convai-studio/integrations/nlp/dialogflow">DialogFlow Integrations</a> guide to connect your Dialogflow bot to Convai.</p></li><li><p>Import this dataset to your Dialogflow Bot - <a href="/ConvaiTutorial.zip"><em>IMPORT ME IN DIALOGFLOW</em></a></p></li><li><p>Once you are done with that, go to Settings &gt; Graph &gt; Extension Graph to add the Dialogflow node.</p></li></ol><img alt="go to extension" src="/img/convai-studio/simple-bot/building-bot/image107.png"><ol start="4"><li>Add the DialogFlow Node to the graph. Connect it between the Request Node and Main Node for NLP to function.</li></ol><img alt="add dialogflow node" src="/img/convai-studio/simple-bot/building-bot/image16.png"><ol start="5"><li>Now you are able to use the NLP using the Intent Links anywhere in the bot. Intent links are like normal if/else loop. For example, if (intent == &#x27;welcome&#x27;) { goForward() }. When you join 2 nodes, click on the link and on the right, you will see a link config. Change the link type to intent and the choose the intent.</li></ol><img alt="intent link" src="/img/convai-studio/simple-bot/building-bot/image95.png"><img alt="select intent" src="/img/convai-studio/simple-bot/building-bot/image80.png"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="adding-analytics"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-analytics" title="Direct link to heading">#</a>Adding Analytics</h2><p>Convai by itself has a Dashboard of Analytics, but you can use other chatbot analytics platform, such as Dashbot. In this section, we will use Dashbot integration to extend the Analytics in the bot.</p><ol><li><p>Integrate Dashbot Analytics using the <a href="/convai-studio/integrations/analytics/dashbot">Dashbot Integration</a> guide.</p></li><li><p>After you successfully integrated Dashbot. Go back to the bot’s graph. Go to Extension Graph via Paginator.</p><p>Add a Dashbot Node by Context Menu and make the graph like below</p><img alt="add dashbot node" src="/img/convai-studio/simple-bot/building-bot/image16.png"></li><li><p>In Dashbot under the Integration Code Section, click View Reports to go to the Dashboard.</p><img alt="view reports" src="/img/convai-studio/simple-bot/building-bot/image34.png"><img alt="dashboard" src="/img/convai-studio/simple-bot/building-bot/image62.png"></li><li><p>Back to Convai. Do some simple execution in the Dev Console.</p><img alt="simple execution" src="/img/convai-studio/simple-bot/building-bot/image27.png"><p>In Dashbot dashboard, you can see that the Live Message Rate has changed, and in Recent Transcripts, there’s a “dev-console-...” which means Dashbot has recorded the transcript of the Dev Console execution in Convai. The other one is the just the execution we tested for our Facebook integration.</p><img alt="analytics" src="/img/convai-studio/simple-bot/building-bot/image63.png"></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="asking-a-single-question-functionality"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#asking-a-single-question-functionality" title="Direct link to heading">#</a>Asking a single question functionality</h2><p>In this section we will add the functionality to get and ask a single question from the user.</p><ol><li><p>Go back to Graph &gt; Main Graph. Create a Module from the Context Menu by right clicking anywhere on the graph</p><img alt="create module" src="/img/convai-studio/simple-bot/building-bot/image47.png"></li><li><p>Rename the Module as “Get Questions”, and connect it to the Any Time System Node</p><img alt="rename module" src="/img/convai-studio/simple-bot/building-bot/image33.png"></li><li><p>Click on the link, change the link type to Intent Link, select AskQuestion(DialogFlow) as the Intent. Any User Input from the Any Time Node that matches this intent will proceed to the Get Questions Module.</p><img alt="select ask question intent" src="/img/convai-studio/simple-bot/building-bot/image50.png"><img alt="graph of module and intent link" src="/img/convai-studio/simple-bot/building-bot/image104.png"><p>The AskQuestion Intent in DialogFlow looks like this:</p><img alt="ask question intent contents" src="/img/convai-studio/simple-bot/building-bot/image75.png"><p>The “triviacategory” entity will be used in the script to call the Trivia API to get quiz questions in different categories. This parameter will be saved in the execution scope.</p><img alt="triviacategory entity" src="/img/convai-studio/simple-bot/building-bot/image35.png"></li><li><p>Double click on the Get Question Module to go inside its graph.</p><img alt="get question graph" src="/img/convai-studio/simple-bot/building-bot/image37.png"></li><li><p>Click on the Input Node and add a Module Variable like the following for the script to use. The qAmount variable will serve as the number of questions we want to get from the API.</p><img alt="set mod var" src="/img/convai-studio/simple-bot/building-bot/image15.png"></li><li><p>Create a Script Node from Context Menu by Right Click &gt; New Node &gt; Stock &gt; Script and rename it as “Get Questions”. Then link it to the Input Node of this Module.</p><p>Write the following code in the Script Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> axios </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;axios&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> amount </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> modvars</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">qAmount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//module variable</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//get triviacategory from Context Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> category </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;triviacategory&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        category </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> category </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set up the baseUrl for API call</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> baseUrl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">https://opentdb.com/api.php?amount=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">amount</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string string" style="color:rgb(195, 232, 141)">&amp;category=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">category</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> axios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">baseUrl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> questions </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">results</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set Session Data questions equal to the result from API Call</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">setSession</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;questions&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><div class="admonition admonition-tip"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Note</h5></div><div class="admonition-content"><p>Here we used <a href="https://www.npmjs.com/package/axios">AXIOS</a> as the HTTP library to call the <a href="https://opentdb.com/api_config.php">Open Trivia Database API</a> to get Quiz questions and store data of questions in the Session Scope Data. Script in Script Node is basically JavaScript, you can use AXIOS or any other HTTP libraries to call external APIs. You can read the more about the script node here - <a href="/convai-studio/nodes/stock/script">Script Node</a>.</p></div></div></li><li><p>Go to the Dev Console on the Right Side Panel (we will refer to it as Side Panel for short). Type “Ask a film question” and hit Enter. Click on View under the bot’s response, scroll down a little bit to inspect the Session Data and the Entity we got from DialogFlow, that is what the Script Node did for us.</p><img alt="get question exec" src="/img/convai-studio/simple-bot/building-bot/image74.png"><img alt="triviacategory data" src="/img/convai-studio/simple-bot/building-bot/image59.png"><img alt="question in session data" src="/img/convai-studio/simple-bot/building-bot/image39.png"><p>If the AskQuestion Intent does not match, session data will look like this</p><img alt="ask question intent no match" src="/img/convai-studio/simple-bot/building-bot/image60.png"></li><li><p>We have the Get Question Module Ready, let’s add another Module named “Ask Question” on the Main Graph, connect it after the Get Question Module. Double click to enter its graph. </p><img alt="add ask question module" src="/img/convai-studio/simple-bot/building-bot/image105.png"><p>Make the module&#x27;s graph like below. Here the:</p><ul><li>Format Question, Validate Answer and Update Points are Script Nodes.</li><li>Question, Correct and Incorrect are Response Nodes.</li><li>User Input is an Input Node.</li><li>Delete Data is a Delete Data Node.</li></ul><img alt="ask question module" src="/img/convai-studio/simple-bot/building-bot/image42.png"></li><li><p>Edit the script of Format Question Script Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> _ </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;lodash&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//for challenge, save the index</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;index&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> currentQuestion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">index </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token keyword nil" style="font-style:italic">undefined</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//get one question from Session Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          q </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;questions&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> options </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set question type in Context Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//multiple choice or true/false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;boolean&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;tf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mc&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correct_answer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">incorrect_answers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">forEach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">o</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">o</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//shuffle the answer options</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          options </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">shuffle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">forEach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">o</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">o </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correct_answer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                  currentQuestion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correctIndex</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//replace character code to character</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          question </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">  q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">question</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/&amp;amp;/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&amp;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/&amp;quot;/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&#x27;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/&amp;#039;/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&#x27;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//put the currentQuestion things in one object</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          currentQuestion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">options</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          currentQuestion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">question</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> question</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          currentQuestion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correctAnswer</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correct_answer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set currentQuestion in Session Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token function" style="color:rgb(130, 170, 255)">setSession</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;currentQuestion&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> currentQuestion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><div class="admonition admonition-tip"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Note</h5></div><div class="admonition-content"><p>Here we used the <a href="https://lodash.com/docs/4.17.15">Lodash</a> utility library to format quiz questions. As mentioned before, Script Node is just JavaScript, you can use any JavaScript features here.</p></div></div></li><li><p>Edit Question Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">typing</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">1</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">{{ session.data.currentQuestion.question }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {%- for op in session.data.currentQuestion.options -%}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {{- forloop.index -}}. {{ op }}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% endfor %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% for op in session.data.currentQuestion.options %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">qr</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">value</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">{{ forloop.index | minus: 1 }}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">{{ op }}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">qr</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {% endfor %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div><p>The Response Node is in <a href="https://shopify.github.io/liquid/">Liquid Template</a>. The preview of this response will look like this:</p><img alt="response preview" src="/img/convai-studio/simple-bot/building-bot/image91.png"></li><li><p>Edit Validate Answer Script Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//user input</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    txt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;%s+&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//correct index</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    correct </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;currentQuestion&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correctIndex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">txt </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> correct</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;correct&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;incorrect&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div></li><li><p>Edit Correct, Incorrect Response Nodes:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Correct! Added 1 to your score.</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Incorrect! Subtracted 1 to your score.</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div></li><li><p>Edit Update Point Script Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//get point from User Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    point </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;point&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set point to 0 if it does not exist</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">point </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token keyword nil" style="font-style:italic">undefined</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        point </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//get correct or incorrect from Context Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;correct&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        point</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;incorrect&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        point</span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set point in User Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;point&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">point</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div></li><li><p>Notice that Validate Answer Script Node has two links to two Response Nodes. We need to take some action on these links otherwise the flow of the graph will always go to the Correct Response Node.</p><p>  Review the script code in Validate Answers Script Node, it sets the execution scope variable “correct” to true if the answer is correct, otherwise it sets “incorrect” to true. We can take this as an advantage in Data Equals Link (Actually the Validate Answers Script Node is intended to do so). </p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//user input</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    txt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;%s+&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//correct index</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    correct </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;currentQuestion&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">correctIndex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">txt </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> correct</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;correct&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;incorrect&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>  Set the link between Validate Answer Script Node and Correct Response Node to be Data Equals Link. Set Field Type as Data, Field Name as “correct”, Operation as Exists.</p><img alt="correct link" src="/img/convai-studio/simple-bot/building-bot/image88.png"><p>  Set the link between Validate Answer Script Node and Incorrect Response Node to be Data Equals Link. Set Field Type as Data, Field Name as “incorrect”, Operation as Exists.</p><img alt="incorrect link" src="/img/convai-studio/simple-bot/building-bot/image30.png"><p>  After the bot updates the user’s point, the stored quiz questions in Session Data are no longer useful. These data should be deleted (clean up). So we add a Delete Data Node at the end of this Module.</p><img alt="delete current question" src="/img/convai-studio/simple-bot/building-bot/image3.png"><p>  Back to the Main Graph, add a Delete Data Node after the Ask Questions Module.</p><img alt="delete current question" src="/img/convai-studio/simple-bot/building-bot/image87.png"><div class="admonition admonition-info"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Note</h5></div><div class="admonition-content"><p>We will explain why we don’t delete s.questions inside the Ask Questions Module in the next section.</p></div></div><p>You can inspect that after the user answers the quiz question, questions stored in Session Data are cleared.</p><img alt="session data before delete" src="/img/convai-studio/simple-bot/building-bot/image40.png"><img alt="session data cleared" src="/img/convai-studio/simple-bot/building-bot/image19.png"></li><li><p>Go to Dev Console in the Side Panel, send “Ask a film question” to the bot. The Bot will respond with the quiz question and you can play with it.</p><img alt="execution result in this section" src="/img/convai-studio/simple-bot/building-bot/image58.png"></li></ol><p>Congratulations, you have built your first Convai chatbot. In this section, you have learned how to use NLP via intent links, and how to call external APIs via Script Nodes. In the next section, we will enhance the bot by reusing the modules you created in this section, and give you an image on how convenient to develop a bot with Modules.</p><p>The Main graph looks like this at the end of this section:</p><img alt="graph in this section" src="/img/convai-studio/simple-bot/building-bot/image4.png"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="creating-a-quiz-challenge-functionality"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-a-quiz-challenge-functionality" title="Direct link to heading">#</a>Creating a quiz challenge functionality</h2><p>In this section, we are going to add a challenge feature which allows the user to answer ten quiz questions and show the user’s final score. And a Get Point feature allows the user to get its points and reset it. And Finally, add a welcome message to give a hint to the user on how to interact with the bot.</p><ol><li><p>On the Main Graph, create a module named “Challenge” and connect it to Any Time System Node with Challenge intent Link, enter its graph.</p><img alt="add challenge module" src="/img/convai-studio/simple-bot/building-bot/image24.png"></li><li><p>Update the graph like below. Here:</p><ul><li>Challenge Starts and Final Score are Response Nodes</li><li>User Input is an Input Node</li><li>Get Questions and Ask Question are modules</li><li>Set Loop Index is a Set Data Node</li><li>Index++ is a Script Node</li><li>Delete Data is a Delete Data Node</li></ul><img alt="challenge module graph" src="/img/convai-studio/simple-bot/building-bot/image14.png"><p>Notice that we are reusing the module we created before - Get Questions and Ask Question Module (Modules has an icon on its top-left corner). When you develop your own bot, think carefully about how to modularize your bot functionalities so that you can reuse them anywhere you need, this makes the development process very flexible.</p></li><li><p>Edit the Challenge Starts Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Let&#x27;s start the challenge!</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div></li><li><p>Remember in the Main graph, the Get Questions Module is connected to the Any Time system Node with AskQuestion intent link. Think Any Time Node as a User Input Node. Therefore, set the link between the User Input Node and Get Questions Module to be AskQuestion intent link.</p><img alt="set ask question intent link" src="/img/convai-studio/simple-bot/building-bot/image25.png"></li><li><p>Click on the Get Questions Module, edit its module variable “qAmount” to 10 in order to get 10 questions from the Trivia API.</p><img alt="set qAmount to 10" src="/img/convai-studio/simple-bot/building-bot/image100.png"></li><li><p>We have got 10 quiz questions from the Get Questions Module, then we need the user to answer these 10 questions. However, the Ask Question Module only asks and lets the user answer one question. Using a loop to loop 10 times of the Ask Question Module is a straightforward strategy here.</p><p>Edit the Set Loop Index Set Data Node:</p><img alt="set loop index" src="/img/convai-studio/simple-bot/building-bot/image2.png"><p>Edit Index++ Script Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//get index from Session Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">session</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;index&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    index</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//set index in Session Data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">setSession</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;index&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div></li><li><p>We need to determine when the loop is finished by using Data Equals Link.</p><img alt="end loop" src="/img/convai-studio/simple-bot/building-bot/image43.png"><p>This loop can be illustrated in the following pseudo-code</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Set Loop Index Node</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">start loop</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token maybe-class-name">Ask</span><span class="token plain"> </span><span class="token maybe-class-name">Questions</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    index</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Index++ Node</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">index </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        end loop </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token maybe-class-name">Delete</span><span class="token plain"> </span><span class="token maybe-class-name">Data</span><span class="token plain"> </span><span class="token maybe-class-name">Node</span></div></code></pre></div></li><li><p>Edit Delete Data Node:</p><img alt="delete index and questions" src="/img/convai-studio/simple-bot/building-bot/image61.png"><p>Remember that we have deleted s.currentQuestions inside the Ask Question Module, if we delete s.questions we got from the API call in that module then we are not able to make the bot ask the next 9 questions in the Challenge Module. So we delete s.questions outside of the Ask Question Module.</p></li><li><p>Edit Final Score Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">You have finished the challenge. Your final score is: {{user.data.point}}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div></li><li><p>The execution of Challenge Module:</p><img alt="challenge module execution" src="/img/convai-studio/simple-bot/building-bot/image1.gif"></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="get-points-functionality"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#get-points-functionality" title="Direct link to heading">#</a>Get points functionality</h2><ol><li><p>We have the Challenge Module ready, now we need a Get Point Module for the user to get its score or reset it. Create this Module on the Main graph and connect it to Any Time system Node with GetPoints intent link.</p><img alt="add get points" src="/img/convai-studio/simple-bot/building-bot/image36.png"></li><li><p>Inside the module, create the graph. Here:</p><ul><li>Your Score, Continue and Reseted Point are Response Nodes</li><li>User Input is an Input Node</li><li>Reset Point is a Set Data Node</li></ul><img alt="get points graph" src="/img/convai-studio/simple-bot/building-bot/image23.png"></li><li><p>Edit Your Score Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Your Score is: {{user.data.point}}. Do you want to reset your score to Zero?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div></li><li><p>This Response Prompts the user to reset its point or not. Use Affirm intent link to ensure that the flow goes to Reset Point Node if the user confirms to reset its point. Otherwise prompt a Continue message.</p><img alt="continue or reset" src="/img/convai-studio/simple-bot/building-bot/image97.png"></li><li><p>Edit Reset Point Set Data Node:</p><img alt="reset point" src="/img/convai-studio/simple-bot/building-bot/image69.png"></li><li><p>Edit Continue Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">You can continue on what you want to do.</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div></li><li><p>Edit Reseted Point Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Your score is set to Zero!</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div></li><li><p>The execution of Get Point Module:</p><img alt="get point execution" src="/img/convai-studio/simple-bot/building-bot/image84.png"></li></ol><p>The main functionalities of this bot is set. But we do need a welcome message. A user is new to this bot, and has completely no idea how this bot works. Welcome message is an essential tool.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="welcomegreet-module"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#welcomegreet-module" title="Direct link to heading">#</a>Welcome/Greet Module</h2><ol><li><p>Create the Welcome Response Node, link it to Start and Any Time System Node with Welcome intent link.</p><img alt="add welcome" src="/img/convai-studio/simple-bot/building-bot/image55.png"></li><li><p>Edit the Welcome Response Node:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-xml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Hi I am the trivia bot. How can I help you?</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">text</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">message</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">response</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></code></pre></div><p>This is just a demonstration of the welcome message, you can add more information to optimize user experience.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="final-product"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#final-product" title="Direct link to heading">#</a>Final Product</h2><p>Congratulations!!!! You have learned how to create a bot with NLP and External APIs, and how to use Modules to make your development process flexible. Let&#x27;s enhance the user experience and add some more channels.</p><p>The graph of the Tutorial Bot:</p><img alt="enhanced bot graph" src="/img/convai-studio/simple-bot/building-bot/image83.png"><p>The overall execution of the Tutorial Bot:</p><img alt="overall execution" src="/img/convai-studio/simple-bot/building-bot/image82.gif"></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/convai-studio/simple-bot/understanding-convai"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Understanding Convai</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/convai-studio/simple-bot/adding-fallback"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Adding Fallback - Enhancing User Experience »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#creating-the-bot" class="contents__link">Creating the bot</a></li><li><a href="#connecting-nlp" class="contents__link">Connecting NLP</a></li><li><a href="#adding-analytics" class="contents__link">Adding Analytics</a></li><li><a href="#asking-a-single-question-functionality" class="contents__link">Asking a single question functionality</a></li><li><a href="#creating-a-quiz-challenge-functionality" class="contents__link">Creating a quiz challenge functionality</a></li><li><a href="#get-points-functionality" class="contents__link">Get points functionality</a></li><li><a href="#welcomegreet-module" class="contents__link">Welcome/Greet Module</a></li><li><a href="#final-product" class="contents__link">Final Product</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center">Copyright © 2020 Datomar Labs Inc.</div></div></footer>
</div>

<script src="/styles.addc9a9b.js"></script>

<script src="/runtime~main.dd004d8d.js"></script>

<script src="/main.e4c7c466.js"></script>

<script src="/1.0b6448a8.js"></script>

<script src="/2.10f14db9.js"></script>

<script src="/103.43e4efd2.js"></script>

<script src="/ec1ed54d.259c8859.js"></script>

<script src="/17896441.c7e96f9c.js"></script>

<script src="/83860a76.d7b5702a.js"></script>


</body>
</html>